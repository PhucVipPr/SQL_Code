CREATE DATABASE BKCSTOREA;
USE BKCSTOREA;

CREATE TABLE PRODUCER(
PRODUCER_ID VARCHAR(10) PRIMARY KEY,
PRODUCER_NAME VARCHAR(50),
);

CREATE TABLE PRODUCT(
PRODUCT_ID VARCHAR(10) PRIMARY KEY,
PRODUCT_NAME VARCHAR(50),
IMPORT_ID VARCHAR(10) FOREIGN KEY REFERENCES IMPORT(IMPORT_ID),
);


CREATE TABLE IMPORT(
IMPORT_ID VARCHAR(10) PRIMARY KEY,
IMPORT_DAY DATE,
PRODUCER_ID VARCHAR(10) FOREIGN KEY REFERENCES PRODUCER(PRODUCER_ID),
);

CREATE TABLE EXPORT(
EXPORT_DAY DATE,
CUSTOMER_ID VARCHAR(10) FOREIGN KEY REFERENCES CUSTOMERS(CUSTOMER_ID),
EMPLOYEE_ID VARCHAR(10) FOREIGN KEY REFERENCES EMPLOYEES(EMPLOYEE_ID),
PRODUCT_ID VARCHAR(10) FOREIGN KEY REFERENCES PRODUCT(PRODUCT_ID),
PRICE MONEY,
);

CREATE TABLE CUSTOMERS(
CUSTOMER_ID VARCHAR(10) PRIMARY KEY,
CUSTOMER_NAME NVARCHAR(50),
PHONENB VARCHAR(10) UNIQUE,
);

CREATE TABLE EMPLOYEES(
EMPLOYEE_ID VARCHAR(10) PRIMARY KEY,
EMPLOYEE_NAME NVARCHAR(50),
);

INSERT INTO PRODUCER VALUES
('NCC1','BKC'),
('NCC2','ALABAMA'),
('NCC3','DANISA');

INSERT INTO PRODUCT VALUES
('SP1','CUA KINH','1'),
('SP2','CUA SO','2'),
('SP3','CUA CHINH','3'),
('SP4','CUA KEO','4'),
('SP5','CUA CUON','5'),
('SP6','CUA GO','6'),
('SP7','CUA SAT','7'),
('SP8','CUA NHOM','8'),
('SP9','CUA XICH','9'),
('SP10','CUA NHUA','10');

INSERT INTO CUSTOMERS VALUES
('KH1','NGUYEN VAN A','0235437231'),
('KH2','NGUYEN THI B','0637296718'),
('KH3','BUI VAN C','0156472854'),
('KH4','TRINH THI D','0774386980'),
('KH5','DO VAN E','0444563242');

INSERT INTO EMPLOYEES VALUES
('NV1','JOHNNY DAMN'),
('NV2','KHOA PUBG'),
('NV3','RHIHAHA'),
('NV4','INDIA JOHN'),
('NV5','MARK FELL');

INSERT INTO IMPORT VALUES
('1','3-4-2019','NCC1'),
('2','1-5-2019','NCC3'),
('3','1-1-2018','NCC1'),
('4','10-11-2019','NCC2'),
('5','12-4-2017','NCC2'),
('6','7-6-2025','NCC1'),
('7','2-1-2016','NCC3'),
('8','4-3-2017','NCC1'),
('9','5-6-2015','NCC1'),
('10','2-8-2014','NCC2');

INSERT INTO EXPORT VALUES
('1-10-2020','KH3','NV5','SP1',100000),
('3-6-2021','KH1','NV2','SP3',500000),
('4-5-2021','KH2','NV2','SP5',250000),
('10-9-2020','KH4','NV3','SP6',650000),
('2-5-2020','KH5','NV4','SP10',1000000),
('7-8-2021','KH1','NV1','SP4',400000),
('6-8-2020','KH1','NV1','SP9',410000),
('7-2-2021','KH1','NV3','SP8',900000),
('5-10-2020','KH1','NV5','SP7',800000),
('12-12-2021','KH1','NV2','SP2',450000);



SELECT * FROM PRODUCT
SELECT * FROM PRODUCER
SELECT * FROM CUSTOMERS
SELECT * FROM EMPLOYEES
SELECT * FROM EXPORT
SELECT * FROM IMPORT


--1
SELECT * FROM PRODUCT

--2
SELECT * FROM EXPORT ORDER BY 
PRICE ASC;

--3
SELECT * FROM EXPORT WHERE 
EMPLOYEE_ID LIKE 'NV1' ORDER BY PRICE DESC;

--4
SELECT * FROM IMPORT WHERE
(YEAR(GETDATE()) - YEAR(IMPORT_DAY)) = '3';

--5
SELECT * FROM CUSTOMERS WHERE
CUSTOMER_NAME LIKE 'NGUYEN%';

--6
SELECT * FROM CUSTOMERS WHERE
CUSTOMER_NAME LIKE '%VAN%';

--7
SELECT COUNT(CUSTOMER_ID)
FROM EXPORT
WHERE CUSTOMER_ID LIKE 'KH1';

--8
SELECT SUM(PRICE)
FROM EXPORT
WHERE EMPLOYEE_ID LIKE 'NV2';

--9
SELECT IMPORT.PRODUCER_ID,PRODUCT.PRODUCT_NAME FROM IMPORT INNER JOIN PRODUCT
ON IMPORT.IMPORT_ID = PRODUCT.IMPORT_ID WHERE IMPORT.IMPORT_ID LIKE '1';

--10
SELECT IMPORT.PRODUCER_ID,PRODUCT.PRODUCT_NAME,PRODUCER.PRODUCER_NAME FROM IMPORT INNER JOIN PRODUCT
ON IMPORT.IMPORT_ID = PRODUCT.IMPORT_ID INNER JOIN PRODUCER 
ON PRODUCER.PRODUCER_ID = IMPORT.PRODUCER_ID WHERE PRODUCER.PRODUCER_NAME LIKE 'BKC';

CREATE FUNCTION FU_PRODUCER()
RETURNS TABLE RETURN
SELECT IMPORT.PRODUCER_ID,PRODUCT.PRODUCT_NAME,PRODUCER.PRODUCER_NAME FROM IMPORT INNER JOIN PRODUCT
ON IMPORT.IMPORT_ID = PRODUCT.IMPORT_ID INNER JOIN PRODUCER 
ON PRODUCER.PRODUCER_ID = IMPORT.PRODUCER_ID WHERE PRODUCER.PRODUCER_NAME LIKE 'BKC'
GO 
SELECT * FROM FU_PRODUCER();











